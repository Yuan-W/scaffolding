{% extends "layout.html" %}

{% block script %}
<!-- Flot Charts JavaScript -->
<script src="{{ url_for('static', filename='vendor/flot/excanvas.min.js') }} "></script>
<script src="{{ url_for('static', filename='vendor/flot/jquery.flot.js') }} "></script>
<script src="{{ url_for('static', filename='vendor/flot/jquery.flot.pie.js') }} "></script>
<script src="{{ url_for('static', filename='vendor/flot/jquery.flot.resize.js') }} "></script>
<script src="{{ url_for('static', filename='vendor/flot/jquery.flot.time.js') }} "></script>
<script src="{{ url_for('static', filename='vendor/flot-tooltip/jquery.flot.tooltip.min.js') }} "></script>
<script>

$(function() {

    var lineData = {
        label: "average",
        data: [[0, 233], [5, 233]],
        lines: {
                    show: true,
                    lineWidth: 1
                }
    };

    var barData = {
        label: "Exercise Time",
        data: [{% for i, time in times %}
                    {{ [i*10,time] }},
                    {% endfor %}
                    ],
        bars: {
                align:"center",
                show: true,
                barWidth: 5,
                fill:true,
                lineWidth:0,
                order:1,
                fillColor:{
                    colors:["#80C3FD","#0089FF"]
                }    
            },
        color:"#0089FF"
    };

    var p = $.plot($("#flot-bar-chart"), [barData, lineData], {
        xaixs:{
            tickLength: 0, // hide gridlines
            axisLabelUseCanvas: true,
            axisLabelFontSizePixels: 12,
            axisLabelFontFamily: 'Verdana, Arial, Helvetica, Tahoma, sans-serif',
            axisLabelPadding: 100,
            ticks:[[0,'Takaoma'],[10,'Giacompany'],[20,'FreshFields'],[30,'Generalisimo'],[40, 'Greenleaves'],[50,'new']]
        },
        yaxis:{
            axisLabel: 's',
            axisLabelUseCanvas: true,
            axisLabelFontSizePixels: 12,
            axisLabelFontFamily: 'Verdana, Arial, Helvetica, Tahoma, sans-serif',
            axisLabelPadding: 5,
            tickSize: 100,
            tickFormatter: function (val, axis) {
                return val;
            },
        },
        grid: {
            hoverable: true,
            clickable: false,
            borderWidth: 0,
            borderColor:'#f0f0f0',
            labelMargin:8,
        },
        series: {
            shadowSize: 1,
        },
        tooltip:true,
        tooltipOpts: {
            id:"chart-tooltip",
            content: "<p><b>20</b> Outgoing Filings</p>" +
                 "<p>Out of <b>10</b> committed;</p>" +
                "<br />" +
                "<p><b>30%</b>% Ratio</p>",
            shifts: {
                x:-74,
                y:-125
            },
            lines:{
                track: true
            },
            compat: true,
        },
    });

    $.each(p.getData()[0].data, function(i, el){
    var o = p.pointOffset({x: el[0], y: el[1]});
    $('<div class="data-point-label">' + el[1] + '</div>').css({
        position: 'absolute',
        left: o.left-10,
        top: o.top - 15,
        display: 'none'
    }).appendTo(p.getPlaceholder()).fadeIn('slow');
    });

    $.each(p.getData()[1].data, function(i, el){
    var o = p.pointOffset({x: el[0], y: el[1]});
    $('<div class="data-point-label">' + el[1] + '</div>').css({
        position: 'absolute',
        left: o.left-10,
        top: o.top - 15,
        display: 'none'
    }).appendTo(p.getPlaceholder()).fadeIn('slow');
    });
});
</script>
{% endblock %}

{% block body %}
<div id="page-wrapper">
    <div class="row">
        <div class="col-lg-12">
            <h1 class="page-header">Dashboard</h1>
        </div>
        <!-- /.col-lg-12 -->
    </div>
    <!-- /.row -->
    <div class="row">
        <div class="col-lg-12">
            <div class="panel panel-default">
                <div class="panel-heading">
                    Exercises
                </div>
                <!-- /.panel-heading -->
                <div class="panel-body">
                    <table width="100%" class="table table-striped table-bordered table-hover" id="dataTables-example">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Number of Students Participated</th>
                                <th>Average Time Spent</th>
                                <th>Average Hints Requested</th>
                            </tr>
                        </thead>
                        <tbody>
                        {% for exercise in exercises %}
                            <tr class="odd gradeX">
                                <td class="center">{{exercise['name']}}</td>
                                <td class="center">{{exercise['student_count']}}</td>
                                <td class="center">{{exercise['average_time_spent']}}</td>
                                <td class="center">{{exercise['average_hints']}}</td>
                            </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                    <!-- /.table-responsive -->
                </div>
                <!-- /.panel-body -->
            </div>
            <!-- /.panel -->
            <div class="panel panel-default">
                <div class="panel-heading">
                    Students
                </div>
                <!-- /.panel-heading -->
                <div class="panel-body">
                    <table width="100%" class="table table-striped table-bordered table-hover" id="dataTables-example">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Number of Exercise Taken</th>
                                <th>Average Hints Requested</th>
                            </tr>
                        </thead>
                        <tbody>
                        {% for student in students %}
                            <tr class="odd gradeX">
                                <td class="center">{{student['name']}}</td>
                                <td class="center">{{student['exercise_count']}}</td>
                                <td class="center">{{student['average_hints']}}</td>
                            </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                    <!-- /.table-responsive -->
                </div>
                <!-- /.panel-body -->
            </div>
        </div>
        <!-- /.col-lg-12 -->
    </div>
    <!-- /.row -->
    <div class="row">
        <div class="col-lg-6">
            <div class="panel panel-default">
                <div class="panel-heading">
                    Bar Chart Example
                </div>
                <!-- /.panel-heading -->
                <div class="panel-body">
                    <div class="flot-chart">
                        <div class="flot-chart-content" id="flot-bar-chart"></div>
                    </div>
                </div>
                <!-- /.panel-body -->
            </div>
            <!-- /.panel -->
        </div>
        <!-- /.col-lg-6 -->
    </div>
    <!-- /.row -->
</div>
<!-- /#page-wrapper -->
{% endblock %}



